<%= erb :'_sidebar' %>

<div class="main-content pull-right">

<% if @user.id == @the_user.id %>
  <h1>My categories</h1>
  <% @the_user.categories.each do |category| %>  
    <div class="container">
      <div class="row">
        <div class="col-sm-2">
          <a href="/category/<%= category.id %>"><%= category.name %></a>
        </div>
        <div class="col-sm-2">
          <form action="/shares/<%=  category.id %>/create" method="POST">
              <button type="submit" class="btn btn-sm btn-info">Share</button>
              <input type="email" name="email" class="form-control" placeholder="example@gmail.com" aria-describedby="basic-addon1">            
          </form>
          </div>
          <div class="col-sm-3">
            <div class="container">
            <% Share.where(category_id: category.id).each do |share| %>
              <div class="row">
                <div class="col-sm-3">
                  <%= share.user.email %>

                  <form class="pull-right" method="post" action="/shares/<%= share.id %>">
                    <input type="hidden" name="_method" value="DELETE" />
                    <button>Delete</button>
                  </form>
                </div>
              </div>
            <% end %>
            </div>
          </div>
          <div class="col-sm-1">
          <form class = "delete-button" onsubmit="return confirm('Confirm category delete?')"action="/category/<%=  category.id %>" method="POST">
            <input type="hidden" name="_method" value="DELETE">
            <button type="submit" class="btn btn-sm btn-danger">Delete </button>
          </form>    
        </div>
      </div> 
  </div> 
  
    <br>
  <% end %>

  <form action="/category/create" method="POST">
    <div class="form-group">
      <label for="exampleInputEmail1">New category name</label>
      <input type="text" class="form-control" name="name" id="exampleInputEmail1" placeholder="Name">
    </div>
    <button type="submit" class="btn btn-default">New Category</button>
  </form>

  
<% else %>
  <div class="category-container container">
    <h1><%= @the_user.first_name %>'s shared categories</h1>
    <% @shares.each do |share| %>
      <div><a href="/category/<%= share.category.id %>"><%= share.category.name %></a></div>
    <% end %>  
  </div>
<% end %>

</div>